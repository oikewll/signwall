<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<title>签到上墙</title>
<meta name="keywords" content="签到上墙" />
<meta name="description" content="签到上墙" />
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no,minimal-ui" />
<meta name="format-detection" content="telephone=no" />
<link rel="stylesheet" href="css/style.css" />
<link rel="stylesheet" href="css/font-awesome.min.css" />
<!--[if IE 7 ]><link rel="stylesheet" href="css/font-awesome-ie7.min.css" /><![endif]-->
</head>

<body>

<section class="container" id="container"></section>

<section class="footer">damn cody by goochin</section>

<textarea id="data-cont" style="display:none;">
	<span class="avatar"><img src="$headimgurl$" id="user_avatar" alt="$nickname$" /></span>
	<p class="notice">Hi~<span id="name1">$nickname$</span>，欢迎您参加本次会议</p>
	<div class="detail" data-area="$country$,$province$,$city$" data-sex="$sex$" data-openid="$openid$">
		<form>
		<ul class="formlist">
			<li class="item">
				<i class="icon-user"></i>
				<input type="text" id="name2" value="$nickname$" />
			</li>
			<li class="item">
				<i class="icon-pushpin"></i>
				<input type="text" id="title" placeholder="描述职位" />
			</li>
			<li class="item">
				<i class="icon-quote-left"></i>
				<input type="text" id="text" placeholder="说点什么吧 :)" />
			</li>
		</ul>
		<button type="submit" class="submit" id="btn-submsign">签到</button>
		</form>
	</div>
</textarea>

<script src="js/jquery.min.js"></script>
<script src="js/common.js"></script>
<script>
$(function(){
	var succsign = '<div class="vertical sign-success" id="tips-success"><i class="icon-check"></i><span class="txt">签到成功~</span></div>';
	var code = GetQueryString("code");
	$.ajax({ 
		async: false,
		url: "oauth2.php", //服务端处理     
		type: "GET",    
		// dataType: 'jsonp',      
		// jsonpCallback:'callback',      
		data: {
			"code":code
		},
		timeout: 5000,
		beforeSend: function(){
			$("#container").html('<div class="vertical" id="loading"><i class="icon-spinner icon-spin"></i></div>')
		},
		success: function (result) {
			$("#loading").remove();
			var result = $.evalJSON(result);
			console.log(result);

			if (result['errcode']) {
				//返回错误码
				console.log(result['errcode']);
			};
			var htmlTemp = $("#data-cont").val();
			var temp = htmlTemp.format(result);
			$("#container").append(temp);
		},
		error: function (jqXHR, textStatus, errorThrown) {
			alert("发生网络错误，请重试 :（ "+textStatus);
		}
	});

	$("#btn-submsign").on("click", function(){
		$("#container").append(succsign);
	});
});
</script>
</body>
</html>